<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Finder</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            transition: background-color 0.3s ease-in-out;
        }

        header {
            background-color: #35424a;
            color: #ffffff;
            padding: 10px 0;
            text-align: center;
        }
        
        main {
            padding: 20px;
        }

        .search-section {
            margin-bottom: 20px;
        }

        .search-section input {
            padding: 10px;
            width: 80%;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        .search-section button {
            padding: 10px 15px;
            background-color: #35424a;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .search-section button:hover {
            background-color: #45a049;
        }
        
        .results-section {
            margin-top: 20px;
        }

        .results-section ul {
            list-style-type: none;
            padding: 0;
        }

        .results-section li {
            background-color: #ffffff;
            margin: 10px 0;
            padding: 15px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        footer {
            background-color: #35424a;
            color: #ffffff;
            text-align: center;
            padding: 10px 0;
            position: relative;
            bottom: 0;
            width: 100%;
        }

        /* The following are the original styles that were in the document */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            transition: background-color 0.3s ease-in-out;
        }
        
    </style>
    <!-- Favicon link -->
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body class="bg-gray-100 min-h-screen flex flex-col justify-between">
    <div class="container mx-auto p-4 sm:p-8 flex-grow">
        <header class="text-center mb-8">
            <h1 class="text-4xl sm:text-5xl font-extrabold text-blue-800">Book Finder ðŸ“š</h1>
            <p class="text-gray-600 mt-2 text-lg">Discover your next great read.</p>
        </header>

        <main class="max-w-3xl mx-auto">
            <section class="search-section bg-white p-6 rounded-2xl shadow-xl mb-8">
                <div class="flex flex-col sm:flex-row gap-4 items-center justify-center">
                    <input type="text" id="search-input" placeholder="Search for books by title or author..." class="flex-grow p-4 border border-gray-300 rounded-xl focus:outline-none focus:ring-4 focus:ring-blue-300 transition-shadow duration-300" />
                    <button id="search-button" class="w-full sm:w-auto p-4 bg-blue-600 text-white font-semibold rounded-xl transition-colors duration-300 hover:bg-blue-700 focus:outline-none focus:ring-4 focus:ring-blue-300">
                        Search
                    </button>
                </div>
            </section>

            <section class="results-section">
                <ul id="results-list" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"></ul>
                <!-- Placeholder for messages (loading, error, no results) -->
                <div id="status-message" class="text-center text-gray-500 mt-8 text-lg font-medium">
                    Start by searching for a book!
                </div>
            </section>
        </main>
    </div>
    
    <footer class="bg-gray-200 text-center p-4">
        <p class="text-gray-600 text-sm">&copy; 2024 Book Finder. All rights reserved.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const searchInput = document.getElementById('search-input');
            const searchButton = document.getElementById('search-button');
            const resultsList = document.getElementById('results-list');
            const statusMessage = document.getElementById('status-message');
            
            // Function to display a status message
            const showStatus = (message, isError = false) => {
                statusMessage.textContent = message;
                statusMessage.className = `text-center mt-8 text-lg font-medium transition-colors duration-300 ${isError ? 'text-red-600' : 'text-gray-500'}`;
            };
            
            // Function to generate a loading skeleton
            const createSkeleton = () => {
                const skeleton = document.createElement('div');
                skeleton.className = "bg-white p-6 rounded-2xl shadow-lg animate-pulse flex flex-col items-center text-center";
                skeleton.innerHTML = `
                    <div class="bg-gray-200 rounded-lg w-full h-48 mb-4"></div>
                    <div class="bg-gray-200 h-6 w-3/4 rounded-md mb-2"></div>
                    <div class="bg-gray-200 h-4 w-1/2 rounded-md"></div>
                `;
                return skeleton;
            };

            // Function to perform the search
            const searchBooks = async () => {
                const query = searchInput.value.trim();
                if (query === '') {
                    showStatus('Please enter a search term.', true);
                    return;
                }
                
                resultsList.innerHTML = ''; // Clear previous results
                
                // Show loading skeletons
                for (let i = 0; i < 6; i++) {
                    resultsList.appendChild(createSkeleton());
                }
                showStatus('Searching for books...');
                
                try {
                    const response = await fetch(`https://openlibrary.org/search.json?q=${encodeURIComponent(query)}`);
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    const data = await response.json();
                    
                    resultsList.innerHTML = ''; // Clear skeletons
                    
                    if (data.docs.length === 0) {
                        showStatus('No books found. Try a different search.');
                    } else {
                        statusMessage.innerHTML = ''; // Clear status message
                        data.docs.forEach(book => {
                            const bookItem = document.createElement('li');
                            bookItem.className = "bg-white p-6 rounded-2xl shadow-lg transition-transform transform hover:-translate-y-2 hover:shadow-2xl duration-300 ease-in-out flex flex-col items-center text-center";
                            
                            const author = book.author_name ? book.author_name.join(', ') : 'Unknown Author';
                            
                            let coverImage = `<div class="bg-gray-200 rounded-lg w-full h-48 mb-4 flex items-center justify-center text-gray-400">No Cover Image</div>`;
                            if (book.cover_i) {
                                coverImage = `<div class="mb-4 w-full">
                                                  <img src="https://covers.openlibrary.org/b/id/${book.cover_i}-M.jpg" alt="${book.title} cover" class="rounded-lg shadow-md w-full h-auto object-cover" onerror="this.onerror=null;this.src='https://placehold.co/150x225/e5e7eb/4b5563?text=No+Image'" />
                                              </div>`;
                            }

                            bookItem.innerHTML = `
                                ${coverImage}
                                <h2 class="text-xl font-bold text-gray-800 mb-1">${book.title}</h2>
                                <p class="text-sm text-gray-500 font-light italic">by ${author}</p>
                            `;
                            resultsList.appendChild(bookItem);
                        });
                    }
                } catch (error) {
                    showStatus('Failed to fetch books. Please try again later.', true);
                    resultsList.innerHTML = ''; // Clear skeletons
                    console.error('Error fetching books:', error);
                }
            };
            
            // Event listeners for search
            searchButton.addEventListener('click', searchBooks);
            searchInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    searchBooks();
                }
            });
        });
    </script>
</body>
</html>
